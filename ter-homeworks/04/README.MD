## Домашнее задание к занятию «Продвинутые методы работы с Terraform»  

### Задание 1  
Возьмите из демонстрации к лекции готовый код для создания ВМ с помощью remote-модуля.  
Создайте одну ВМ, используя этот модуль. В файле cloud-init.yml необходимо использовать переменную для ssh-ключа вместо хардкода. Передайте ssh-ключ в функцию template_file в блоке vars ={} . Воспользуйтесь примером. Обратите внимание, что ssh-authorized-keys принимает в себя список, а не строку.  
Добавьте в файл cloud-init.yml установку nginx.  
Предоставьте скриншот подключения к консоли и вывод команды sudo nginx -t.  

#### Ответ:  

### Задание 2  
Напишите локальный модуль vpc, который будет создавать 2 ресурса: одну сеть и одну подсеть в зоне, объявленной при вызове модуля, например: ru-central1-a.  
Вы должны передать в модуль переменные с названием сети, zone и v4_cidr_blocks.  
Модуль должен возвращать в root module с помощью output информацию о yandex_vpc_subnet. Пришлите скриншот информации из terraform console о своем модуле. Пример: > module.vpc_dev  
Замените ресурсы yandex_vpc_network и yandex_vpc_subnet созданным модулем. Не забудьте передать необходимые параметры сети из модуля vpc в модуль с виртуальной машиной.  
Откройте terraform console и предоставьте скриншот содержимого модуля. Пример: > module.vpc_dev.  
Сгенерируйте документацию к модулю с помощью terraform-docs.  
Пример вызова  
```
module "vpc_dev" {
  source       = "./vpc"
  env_name     = "develop"
  zone = "ru-central1-a"
  cidr = "10.0.1.0/24"
}
```

#### Ответ:  

### Задание 3  
Выведите список ресурсов в стейте.  
Полностью удалите из стейта модуль vpc.  
Полностью удалите из стейта модуль vm.  
Импортируйте всё обратно. Проверьте terraform plan. Изменений быть не должно. Приложите список выполненных команд и скриншоты процессы.  

#### Ответ:  

Дополнительные задания (со звёздочкой*)  
Настоятельно рекомендуем выполнять все задания со звёздочкой. Они помогут глубже разобраться в материале.  
Задания со звёздочкой дополнительные, не обязательные к выполнению и никак не повлияют на получение вами зачёта по этому домашнему заданию.  

### Задание 4*
Измените модуль vpc так, чтобы он мог создать подсети во всех зонах доступности, переданных в переменной типа list(object) при вызове модуля.  
Пример вызова  
```
module "vpc_prod" {
  source       = "./vpc"
  env_name     = "production"
  subnets = [
    { zone = "ru-central1-a", cidr = "10.0.1.0/24" },
    { zone = "ru-central1-b", cidr = "10.0.2.0/24" },
    { zone = "ru-central1-c", cidr = "10.0.3.0/24" },
  ]
}

module "vpc_dev" {
  source       = "./vpc"
  env_name     = "develop"
  subnets = [
    { zone = "ru-central1-a", cidr = "10.0.1.0/24" },
  ]
}
```
Предоставьте код, план выполнения, результат из консоли YC.

#### Ответ:  
